javascript:(function()%7Basync%20function%20initMain()%7Bvar%20unqHsh%20%3D%20(a%2Co)%20%3D%3E%20a.filter(i%3D%3E%20o.hasOwnProperty(i)%20%3F%20false%20%3A%20(o%5Bi%5D%20%3D%20true))%3Bconst%20cn%20%3D%20(o%2C%20s)%20%3D%3E%20o%3F.getElementsByClassName(s)%3Bconst%20tn%20%3D%20(o%2C%20s)%20%3D%3E%20o%3F.getElementsByTagName(s)%3Bconst%20gi%20%3D%20(o%2C%20s)%20%3D%3E%20o%3F.getElementById(s)%3Bconst%20rando%20%3D%20(n)%20%3D%3E%20Math.round(Math.random()%20*%20n)%3Bconst%20unq%20%3D%20(arr)%20%3D%3E%20arr.filter((e%2C%20p%2C%20a)%20%3D%3E%20a.indexOf(e)%20%3D%3D%20p)%3Bconst%20delay%20%3D%20(ms)%20%3D%3E%20new%20Promise(res%20%3D%3E%20setTimeout(res%2C%20ms))%3Bconst%20ele%20%3D%20(t)%20%3D%3E%20document.createElement(t)%3Bconst%20attr%20%3D%20(o%2C%20k%2C%20v)%20%3D%3E%20%7Btry%7Bo.setAttribute(k%2C%20v)%3B%7Dcatch(err)%7Bconsole.log(%5Berr%2Co%2Ck%2Cv%5D)%3B%7D%7D%3Bconst%20a%20%3D%20(l%2C%20r)%20%3D%3E%20r.forEach(a%20%3D%3E%20attr(l%2C%20a%5B0%5D%2C%20a%5B1%5D))%3Bfunction%20topZIndexer()%7Blet%20n%20%3D%20new%20Date().getTime()%20%2F%201000000%3Blet%20r%20%3D%20(n%20-%20Math.floor(n))%20*%20100000%3Breturn%20(Math.ceil(n%2Br)%20*%2010)%3B%7Dfunction%20inlineStyler(elm%2Ccss)%7Bif(elm)%7BObject.entries(JSON.parse(css.replace(%2F(%3F%3C%3D%3A)%5Cs*(%5Cb%7C%5CB)(%3F%3D.%2B%3F%3B)%2Fg%2C'%22').replace(%2F(%3F%3C%3D%3A%5Cs*.%2B%3F)%3B%2Fg%2C'%22%2C').replace(%2F%5Ba-zA-Z-%5D%2B(%3F%3D%3A)%2Fg%2C%20k%3D%3E%20k.replace(%2F%5E%5Cb%2F%2C'%22').replace(%2F%5Cb%24%2F%2C'%22')).replace(%2F%5Cs*%2C%5Cs*%5C%7D%2Fg%2C'%7D'))).forEach(kv%3D%3E%20%7B%20elm.style%5Bkv%5B0%5D%5D%20%3D%20kv%5B1%5D%7D)%3B%7D%7Dfunction%20dragElement()%20%7Bvar%20el%20%3D%20this.parentElement.parentElement%3Bvar%20pos1%20%3D%200%2C%20%20%20%20pos2%20%3D%200%2C%20%20%20%20pos3%20%3D%200%2C%20%20%20%20pos4%20%3D%200%3Bif%20(document.getElementById(this.id))%20document.getElementById(this.id).onmousedown%20%3D%20dragMouseDown%3Belse%20this.onmousedown%20%3D%20dragMouseDown%3Bfunction%20dragMouseDown(e)%20%7Bpos3%20%3D%20e.clientX%3Bpos4%20%3D%20e.clientY%3Bdocument.onmouseup%20%3D%20closeDragElement%3Bdocument.onmousemove%20%3D%20elementDrag%3BinlineStyler(el%2C%60%7Bz-index%3A%20%24%7BtopZIndexer()%7D%3B%7D%60)%3B%7Dfunction%20elementDrag(e)%20%7Bpos1%20%3D%20pos3%20-%20e.clientX%3Bpos2%20%3D%20pos4%20-%20e.clientY%3Bpos3%20%3D%20e.clientX%3Bpos4%20%3D%20e.clientY%3BinlineStyler(el%2C%60%7Btop%3A%20%24%7B(el.offsetTop%20-%20pos2)%7Dpx%3B%20left%3A%20%24%7B(el.offsetLeft%20-%20pos1)%7Dpx%3B%20opacity%3A%200.85%3B%20transition%3A%20opacity%20100ms%3B%7D%60)%3B%7Dfunction%20closeDragElement()%20%7Bdocument.onmouseup%20%3D%20null%3Bdocument.onmousemove%20%3D%20null%3Bel.style.opacity%20%3D%20%221%22%3B%7D%7Dfunction%20setQuickliCSS(main_cont_id)%7Bif(gi(document%2C%60%24%7Bmain_cont_id%7D_style%60))%20gi(document%2C%60%24%7Bmain_cont_id%7D_style%60).outerHTML%20%3D%20''%3Blet%20csselm%20%3D%20ele('style')%3Ba(csselm%2C%5B%5B'class'%2C%60%24%7Bmain_cont_id%7D_style%60%5D%5D)%3Bdocument.head.appendChild(csselm)%3Bcsselm.innerHTML%20%3D%20%60.pad2%20%7Bpadding%3A%202px%3B%7D.pad4%20%7Bpadding%3A%204px%3B%7D.pad6%20%7Bpadding%3A%206px%3B%7D.pad8%20%7Bpadding%3A%208px%3B%7D.centertext%20%7Btext-align%3A%20center%3B%7D.h32%20%7Bheight%3A%2032px%3B%7D.mover-top-gradient%20%7Bbackground%3A%20linear-gradient(to%20bottom%20right%2C%20%23ffffff%2C%20%23ffffff%2C%20%23ffffff%2C%20%23f2f2f2%2C%20%23ededed%2C%20%23e0e0e0%2C%20%23bababa%2C%20%23bababa)%3Bbackground-size%3A%20400%25%20400%25%3Banimation%3A%20move_gradient%205s%20ease%20infinite%3Bborder-top-left-radius%3A0.2em%3Bborder-top-right-radius%3A1em%3Bborder-bottom-left-radius%3A0px%3Bborder-bottom-right-radius%3A0px%3B%7D.mover-left-gradient%20%7Bbackground%3A%20linear-gradient(to%20bottom%20right%2C%20%23ffffff%2C%20%23ffffff%2C%20%23ffffff%2C%20%23f2f2f2%2C%20%23ededed%2C%20%23e0e0e0%2C%20%23bababa%2C%20%23bababa)%3Bbackground-size%3A%20400%25%20400%25%3Banimation%3A%20move_gradient%205s%20ease%20infinite%3Bborder-top-left-radius%3A1em%3Bborder-top-right-radius%3A0em%3Bborder-bottom-left-radius%3A1em%3Bborder-bottom-right-radius%3A0.4em%3B%7D%40keyframes%20move_gradient%20%7B0%25%20%7Bbackground-position%3A%200%25%2050%25%3B%7D50%25%20%7Bbackground-position%3A%20100%25%2050%25%3B%7D100%25%20%7Bbackground-position%3A%200%25%2050%25%3B%7D%7D.quickli_options_container_main%20%7Bbackground%3A%20linear-gradient(-45deg%2C%20%23ee7752%2C%20%23e73c7e%2C%20%2323a6d5%2C%20%2323a6d5%2C%20%2323d5ab)%3Bbackground-size%3A%20400%25%20400%25%3Banimation%3A%20gradient_quickli%203s%20ease%20infinite%3B%7D%40keyframes%20gradient_quickli%20%7B0%25%20%7Bbackground-position%3A%200%25%2050%25%3B%7D50%25%20%7Bbackground-position%3A%20100%25%2050%25%3B%7D100%25%20%7Bbackground-position%3A%200%25%2050%25%3B%7D%7D.textarea%20%7Boutline%3A%20none%3Bborder-radius%3A%200.4em%3Bborder%3A%200px%3Bbackground%3A%20transparent%3Bbox-shadow%3A%20rgb(204%2C%20219%2C%20232)%202px%202px%204px%201px%20inset%2C%20rgba(255%2C%20255%2C%20255%2C%200.5)%20-1px%20-2px%204px%202px%20inset%3Bcolor%3A%20%23788fa5%3Btransition%3A%20all%20333ms%3B%7D.textarea%3Afocus%20%7Bbox-shadow%3A%20rgb(204%2C%20219%2C%20232)%202px%204px%204px%201px%20inset%2C%20rgba(255%2C%20255%2C%20255%2C%200.5)%20-2px%20-2px%204px%202px%20inset%3B%7D.q_btn%7Bbox-shadow%3A%20rgba(0%2C%200%2C%200%2C%200.1)%200px%201px%202px%200px%3Bfont-size%3A%201.2em%3Bcursor%3A%20pointer%3Bbackground%3A%20%23ffffff%3Bcolor%3A%20%23788fa5%3Bborder-radius%3A%202em%3Btransition%3A%20all%20111ms%3Buser-select%3A%20none%3B%7D.q_btn%3Ahover%20%7Bbox-shadow%3A%20rgba(136%2C%20165%2C%20191%2C%200.48)%206px%202px%206px%200px%2C%20rgba(255%2C%20255%2C%20255%2C%200.8)%20-6px%20-2px%206px%20-3px%3Bcolor%3A%20%23788fa5%3B%7D.q_btn%3Aactive%20%7Bbox-shadow%3A-8px%20-4px%208px%200px%20%23ffffff%2C6px%202px%206px%200px%20rgb(204%2C%20219%2C%20232)%2C4px%204px%204px%200px%20rgb(204%2C%20219%2C%20232)%20inset%2C-4px%20-4px%204px%200px%20%23ffffff%20inset%3Bcolor%3A%20%23788fa5%3B%7D%60%3B%7DsetQuickliCSS('file_cleaner')%3Bfunction%20keepElmInBoundary(elm)%7Bif(elm.getBoundingClientRect().right%20%3E%3D%20window.innerWidth)%7BinlineStyler(elm%2C%60%7Bleft%3A%20%24%7B(window.innerWidth%20-%20(parseInt(%2F%5E%5Cd%2B%2F.exec(window.getComputedStyle(elm).maxWidth)%3F.%5B0%5D)%2B30))%7Dpx%3B%7D%60)%3B%7Dif(elm.getBoundingClientRect().bottom%20%3E%3D%20window.innerHeight)%7BinlineStyler(elm%2C%60%7Btop%3A%20%24%7B(window.innerHeight%20-%20(elm.getBoundingClientRect().height%2B60))%7Dpx%3B%7D%60)%3B%7D%7Dif(gi(document%2C'spreadsheet_cleaner'))%20gi(document%2C'spreadsheet_cleaner').outerHTML%20%3D%20''%3Bconst%20height%20%3D%20window.innerHeight%20%3C%3D600%20%3F%20window.innerHeight%20*%200.9%20%3A%20window.innerHeight%20%3E%20600%20%26%26%20window.innerHeight%20%3C%201100%20%3F%20window.innerHeight%20*%200.7%20%3A%20window.innerHeight%20*%200.6%3Bconst%20width%20%3D%20window.innerWidth%20%3C%3D%20800%20%3F%20window.innerWidth%20*%200.9%20%3A%20window.innerWidth%20%3E%20800%20%26%26%20window.innerWidth%20%3C%201161%20%3F%20window.innerWidth%20*%200.7%20%3A%20window.innerWidth%20*%200.6%3Bconst%20left_p_h%20%3D%20width%20%3C%20500%20%3F%20width%20*%200.6%20%3A%20500%3Bconst%20height_p_h%20%3D%20height%20%3C%20600%20%3F%20height%20*%200.7%20%3A%20520%3Blet%20cont%20%3D%20ele('div')%3Ba(cont%2C%5B%5B'id'%2C'spreadsheet_cleaner'%5D%5D)%3Bdocument.body.appendChild(cont)%3Blet%20shadow%20%3D%20'box-shadow%3A%20rgba(0%2C%200%2C%200%2C%200.07)%200px%201px%202px%2C%20rgba(0%2C%200%2C%200%2C%200.07)%200px%202px%204px%2C%20rgba(0%2C%200%2C%200%2C%200.07)%200px%204px%208px%2C%20rgba(0%2C%200%2C%200%2C%200.07)%200px%208px%2016px%2C%20rgba(0%2C%200%2C%200%2C%200.07)%200px%2016px%2032px%2C%20rgba(0%2C%200%2C%200%2C%200.07)%200px%2032px%2064px%3B'%3BinlineStyler(cont%2C%60%7Bdisplay%3A%20grid%3B%20grid-template-columns%3A%2032px%201fr%3B%20grid-gap%3A%200px%3B%20%24%7Bshadow%7D%20text-align%3A%20left%3B%20max-height%3A%20%24%7Bheight%7Dpx%3B%20max-width%3A%20%24%7Bwidth%7Dpx%3B%20background%3A%20%23ffffff%3B%20color%3A%20%23374552%3B%20border-radius%3A%201em%3B%20transition%3A%20all%20111ms%3B%20position%3A%20fixed%3B%20z-index%3A%20%24%7BtopZIndexer()%7D%3B%20top%3A%201500px%3B%20left%3A%205000px%3B%7D%60)%3Bconst%20panel%20%3D%20ele('div')%3Ba(panel%2C%5B%5B'class'%2C'mover-left-gradient'%5D%5D)%3BinlineStyler(panel%2C%60%7Bdisplay%3A%20grid%3B%20grid-template-rows%3A%2032px%20%24%7Bheight-60%7Dpx%3B%20grid-gap%3A%2012px%3B%20user-select%3A%20none%3B%7D%60)%3Bcont.appendChild(panel)%3Bconst%20cls%20%3D%20ele('div')%3Bpanel.appendChild(cls)%3Ba(cls%2C%5B%5B'class'%2C'q_btn%20h32'%5D%5D)%3Bcls.innerHTML%20%3D%20%60%3Csvg%20style%3D%22border-radius%3A%202em%3B%20height%3A%2030px%3B%20width%3A%2030px%3B%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%3E%3Cg%20style%3D%22transform%3A%20scale(1%2C%201)%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cg%20transform%3D%22translate(2%2C%202)%22%20stroke%3D%22%23e21212%22%20stroke-width%3D%228%22%3E%3Cpath%20d%3D%22M47.806834%2C19.6743435%20L47.806834%2C77.2743435%22%20transform%3D%22translate(49%2C%2050)%20rotate(225)%20translate(-49%2C%20-50)%20%22%2F%3E%3Cpath%20d%3D%22M76.6237986%2C48.48%20L19.0237986%2C48.48%22%20transform%3D%22translate(49%2C%2050)%20rotate(225)%20translate(-49%2C%20-50)%20%22%2F%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E%60%3Bcls.onclick%20%3D%20()%20%3D%3E%20cont.outerHTML%20%3D%20''%3Bconst%20mover%20%3D%20ele('div')%3BinlineStyler(mover%2C%60%7Bcursor%3A%20move%3B%20user-select%3A%20none%3B%7D%60)%3Bpanel.appendChild(mover)%3Bmover.onmouseover%20%3D%20dragElement%3Bconst%20right%20%3D%20ele('div')%3BinlineStyler(right%2C%60%7Bpadding%3A%200px%3B%7D%60)%3Bcont.appendChild(right)%3Bconst%20head%20%3D%20ele('div')%3Ba(head%2C%5B%5B'class'%2C'mover-top-gradient%20pad4'%5D%5D)%3BinlineStyler(head%2C%60%7Bcolor%3A%20%23e3291b%3B%20text-align%3A%20center%3B%20cursor%3A%20move%3B%20user-select%3A%20none%3B%7D%60)%3Bright.appendChild(head)%3Bhead.innerText%20%3D%20%60Upload%20TSV%20or%20CSV%20files%60%3Bhead.onmouseover%20%3D%20dragElement%3Blet%20files_cont%20%3D%20ele('div')%3BinlineStyler(files_cont%2C%60%7Bdisplay%3A%20grid%3B%20grid-template-columns%3A%201fr%201fr%3B%20grid-gap%3A%208px%3B%20padding%3A12px%3B%7D%60)%3Bright.appendChild(files_cont)%3Blet%20clean_cont%20%3D%20ele('div')%3Bfiles_cont.appendChild(clean_cont)%3BinlineStyler(clean_cont%2C%60%7Bdisplay%3A%20grid%3B%20grid-gap%3A%204px%3B%7D%60)%3Bclean_cont.innerHTML%20%3D%20%60%3Cdiv%3EClean%20This%20Data%3C%2Fdiv%3E%60%3Blet%20clean_this_file%20%3D%20ele('input')%3Ba(clean_this_file%2C%20%5B%5B'id'%2C%20'clean_this_file'%5D%2C%5B'type'%2C%20'file'%5D%2C%5B'name'%2C%20'file%5B%5D'%5D%2C%5B'multiple'%2C%20'true'%5D%5D)%3Bclean_cont.appendChild(clean_this_file)%3Bclean_this_file.onchange%20%3D%20addRunCleanerBtn%3Blet%20rmv_cont%20%3D%20ele('div')%3Bfiles_cont.appendChild(rmv_cont)%3BinlineStyler(rmv_cont%2C%60%7Bdisplay%3A%20grid%3B%20grid-gap%3A%204px%3B%7D%60)%3Brmv_cont.innerHTML%20%3D%20%60%3Cdiv%3EFrom%20This%20Data%3C%2Fdiv%3E%60%3Blet%20file_with_cells_to_remove%20%3D%20ele('input')%3Ba(file_with_cells_to_remove%2C%20%5B%5B'id'%2C%20'file_with_cells_to_remove'%5D%2C%5B'type'%2C%20'file'%5D%2C%5B'name'%2C%20'file%5B%5D'%5D%2C%5B'multiple'%2C%20'true'%5D%5D)%3Brmv_cont.appendChild(file_with_cells_to_remove)%3Bfile_with_cells_to_remove.onchange%20%3D%20handleRmvFile%3Blet%20rmv_opt_cont%20%3D%20ele('div')%3Ba(rmv_opt_cont%2C%5B%5B'id'%2C'rmv_opt_cont'%5D%5D)%3BinlineStyler(rmv_opt_cont%2C%60%7Bmax-height%3A%20%24%7Bheight-100%7Dpx%3B%20overflow-y%3Aauto%3B%20padding%3A12px%3B%7D%60)%3Bright.appendChild(rmv_opt_cont)%3Brmv_opt_cont.innerHTML%20%3D%20%60%3Cdiv%20style%3D%22height%3A20px%3B%20width%3A100%25%3B%20border-bottom%3A%201px%20solid%20%231c1c1c%3B%22%3E%3C%2Fdiv%3E%60%3BkeepElmInBoundary(cont)%3Bfunction%20createInterfaceToSpecifyRemoveHeaders(headers)%7BinlineStyler(rmv_opt_cont%2C%60%7Bdisplay%3A%20grid%3B%20grid-gap%3A8px%3B%7D%60)%3Blet%20information%20%3D%20ele('div')%3Brmv_opt_cont.appendChild(information)%3Binformation.innerText%20%3D%20'Select%20%22Clear%20Entire%20Row%22%20to%20clear%20the%20entire%20row%20from%20your%20first%20sheet%2C%20or%20leave%20false%20if%20you%20wish%20to%20only%20clear%20the%20cells%20from%20the%20target%20columns.'%3B%5B...%5B'Clear%20Entire%20Row'%5D%2C...headers%5D.forEach((itm%2Ci)%3D%3E%20%7Bif(i%20%3C%3D%201)%7Blet%20head_text%20%3D%20ele('div')%3Brmv_opt_cont.appendChild(head_text)%3Bhead_text.innerText%20%3D%20%20i%20%3D%3D%200%20%3F%20''%20%3A%20'Select%20cells%20to%20target%20in%20column%20headers%20listed%20below.'%3B%7Dlet%20field%20%3D%20ele('div')%3Brmv_opt_cont.appendChild(field)%3Ba(field%2C%5B%5B'class'%2C'search_field'%5D%5D)%3BinlineStyler(field%2C%60%7Bdisplay%3A%20grid%3B%20grid-template-columns%3A%2052px%201fr%3B%20grid-gap%3A6px%3B%7D%60)%3Blet%20btn%20%3D%20ele('div')%3Bfield.appendChild(btn)%3Ba(btn%2C%5B%5B'class'%2C'textarea'%5D%5D)%3BaddTypeSwitch(btn%2C%60toggle_%24%7B(i-1)%7D%60%2C(i-1))%3Blet%20label%20%3D%20ele('div')%3Bfield.appendChild(label)%3Blabel.innerText%20%3D%20itm%3B%7D)%3B%7Dfunction%20addTypeSwitch(parent_elm%2Cid%2Cindex)%7Blet%20boolopt%20%3D%20ele('div')%3Bparent_elm.appendChild(boolopt)%3Ba(boolopt%2C%5B%5B'id'%2Cid%5D%2C%5B'class'%2C'q_btn%20switch_btn'%5D%2C%5B'boolx'%2C'false'%5D%2C%5B'index'%2Cindex%5D%5D)%3BinlineStyler(boolopt%2C%60%7Bz-index%3A%20%24%7BtopZIndexer()%2B1500%7D%3B%20height%3A%2020px%3B%20width%3A%2020px%3B%20background%3A%20%238a0e00%3B%20border%3A%201px%20solid%20%23d4e4ff%3B%20box-shadow%3A%20rgba(136%2C%20165%2C%20191%2C%200.48)%206px%202px%206px%200px%2C%20rgba(255%2C%20255%2C%20255%2C%200.8)%20-6px%20-2px%206px%20-3px%3B%20transform%3Atranslate(28px%2C0px)%3B%7D%60)%3Bboolopt.onclick%20%3D%20everySomeSwitchRxBool%3Blet%20boolcard%20%3D%20ele('div')%3Bparent_elm.appendChild(boolcard)%3BinlineStyler(boolcard%2C%60%7Buser-select%3A%20none%3B%20z-index%3A%20%24%7BtopZIndexer()%7D%3B%20background%3A%20transparent%3B%20color%3A%20%238a0e00%3B%20text-align%3A%20center%3B%20transform%3Atranslate(0px%2C0px)%3B%7D%60)%3Bboolcard.innerText%20%3D%20'false'%3B%7Dfunction%20everySomeSwitchRxBool()%7Blet%20status%20%3D%20this.getAttribute('boolx')%3Blet%20display%20%3D%20tn(this.parentElement%2C'div')%5B1%5D%3Bif(status%20%3D%3D%3D%20'true')%7Ba(this%2C%5B%5B'boolx'%2C'false'%5D%5D)%3BinlineStyler(this%2C%60%7Btransform%3Atranslate(28px%2C0px)%3B%20background%3A%238a0e00%3B%7D%60)%3BinlineStyler(display%2C%60%7Bcolor%3A%238a0e00%3B%20text-align%3A%20center%3B%20transform%3Atranslate(0px%2C0px)%3B%7D%60)%3Bdisplay.innerText%20%3D%20'false'%3B%7Delse%7Ba(this%2C%5B%5B'boolx'%2C'true'%5D%5D)%3BinlineStyler(this%2C%60%7Btransform%3Atranslate(0px%2C0px)%3B%20background%3A%23008a0e%3B%7D%60)%3BinlineStyler(display%2C%60%7Bcolor%3A%23008a0e%3B%20text-align%3A%20center%3B%20transform%3Atranslate(0px%2C0px)%3B%7D%60)%3Bdisplay.innerText%20%3D%20'true'%3B%7D%7Dasync%20function%20handleRmvFile()%7Bvar%20transpose%20%3D%20(rr)%3D%3E%20%20rr%5B0%5D.map((_%2C%20c)%3D%3E%20rr.map(r%3D%3E%20r%5Bc%5D))%3Bvar%20remove_this%20%3D%20await%20getAsText(this.files%5B0%5D)%3Bvar%20trans_remove_this%20%3D%20transpose(remove_this%3F.table)%3Bvar%20remove_headers%20%3D%20trans_remove_this.map(t%3D%3E%20t%5B0%5D)%3BcreateInterfaceToSpecifyRemoveHeaders(remove_headers)%3BaddRunCleanerBtn()%7Dasync%20function%20addRunCleanerBtn()%7Bif(!gi(document%2C'run_cleaner')%20%26%26%20file_with_cells_to_remove.files%3F.length%20%26%26%20clean_this_file.files%3F.length%20)%7Blet%20run_cleaner%20%3D%20ele('div')%3Ba(run_cleaner%2C%5B%5B'id'%2C'run_cleaner'%5D%2C%5B'class'%2C'q_btn%20centertext%20pad8'%5D%5D)%3Bright.appendChild(run_cleaner)%3Brun_cleaner.innerText%20%3D%20'Run%20Program'%3Brun_cleaner.onclick%20%3D%20handleFiles%3B%7D%7Dasync%20function%20handleFiles()%7Bvar%20transpose%20%3D%20(rr)%3D%3E%20%20rr%5B0%5D.map((_%2C%20c)%3D%3E%20rr.map(r%3D%3E%20r%5Bc%5D))%3Bvar%20clean_this%20%3D%20await%20getAsText(clean_this_file.files%5B0%5D)%3Bvar%20trans_clean_this%20%3D%20transpose(clean_this%3F.table)%3Bvar%20remove_this%20%3D%20await%20getAsText(file_with_cells_to_remove.files%5B0%5D)%3Bvar%20trans_remove_this%20%3D%20transpose(remove_this%3F.table)%3Blet%20indexes%20%3D%20Array.from(cn(document%2C'switch_btn'))%3F.filter(elm%3D%3E%20elm.getAttribute('boolx')%20%3D%3D%3D%20'true').map(elm%3D%3E%20parseInt(elm.getAttribute('index')))%3Blet%20clear_all_cells_in_row%20%3D%20indexes%5B0%5D%20%3D%3D%3D%20-1%3Blet%20clear_cols%20%3D%20trans_remove_this.filter((_%2Ci)%3D%3E%20indexes.some(ix%3D%3E%20ix%20%3D%3D%3D%20i))%3Blet%20clear_any_of_these_cells%20%3D%20clear_cols.map(col%3D%3E%20%7Bcol.shift()%3B%20return%20col%3B%7D).flat().flat()%3Blet%20rows_to_clear%20%3D%20%5B%5D%3Blet%20cleaned_by_cell%20%3D%20trans_clean_this.map((target_col%2Ccol_index)%3D%3E%20%7Breturn%20target_col.map((target_cell%2Crow_index)%3D%3E%20%7Blet%20is_match%20%3D%20clear_any_of_these_cells.some(cc%3D%3E%20cc.toLowerCase()%20%3D%3D%3D%20target_cell.toLowerCase())%3Bif(is_match)%20rows_to_clear.push(row_index)%3Breturn%20is_match%20%3F%20''%20%3A%20target_cell%3B%7D)%7D)%3Bif(clear_all_cells_in_row%20%26%26%20rows_to_clear.length)%7Blet%20clear_these%20%3D%20unqHsh(rows_to_clear%2C%7B%7D)%3Blet%20cleaned_by_row%20%3D%20cleaned_by_cell.map(target_col%3D%3E%20target_col.map((target_cell%2Crow_index)%3D%3E%20clear_these.some((ii)%3D%3E%20ii%20%3D%3D%20row_index)%20%3F%20''%20%3A%20target_cell))%3Breconvert(transpose(cleaned_by_row)%2Cclean_this_file.files%5B0%5D.name)%3Bawait%20delay(500)%3Bcont.outerHTML%20%3D%20''%3B%7Delse%7Breconvert(transpose(cleaned_by_cell)%2Cclean_this_file.files%5B0%5D.name)%3Bawait%20delay(500)%3Bcont.outerHTML%20%3D%20''%3B%7D%7Dfunction%20reconvert(arr%2Cfilename)%7Blet%20deliminator%20%3D%20%2Fcsv%24%2F.test(filename)%20%3F%20'%2C'%20%3A%20'%5Ct'%3Blet%20data%20%3D%20arr.map(row%3D%3E%20row.map(cell%3D%3E%20cell%2Bdeliminator).reduce((a%2Cb)%3D%3E%20a%2Bb)%2B'%5Cn').reduce((a%2Cb)%3D%3E%20a%2Bb)%3B%20%2F*possible%20issue%20here%20if%20the%20name%20input%20return%20contains%20a%20comma%20or%20a%20tab.%20should%20clean%20that%20out%20in%20the%20background*%2Flet%20type%20%3D%20'data%3Atext%2Fplain%3Bcharset%3Dutf-8%2C'%3Bvar%20file%20%3D%20new%20Blob(%5Bdata%5D%2C%20%7B%20%20%20%20type%3A%20type%20%20%7D)%3Bif%20(window.navigator.msSaveOrOpenBlob)%20%7Bwindow.navigator.msSaveOrOpenBlob(file%2C%20'cleaned%20-%20'%2Bfilename)%3B%7D%20else%20%7Bvar%20a%20%3D%20document.createElement('a')%2Curl%20%3D%20URL.createObjectURL(file)%3Ba.href%20%3D%20url%3Ba.download%20%3D%20'cleaned%20-%20'%2Bfilename%3Bdocument.body.appendChild(a)%3Ba.click()%3BsetTimeout(()%20%3D%3E%20%7Bdocument.body.removeChild(a)%3Bwindow.URL.revokeObjectURL(url)%3B%7D%2C%2010)%3B%7D%7Dasync%20function%20getAsText(f)%20%7Bif(%2F%5C.tsv%7C%5C.csv%2Fi.test(f.name))%7Blet%20x%20%3D%20%2F%5C.tsv%2Fi.test(f.name)%20%3F%20%2F%5Ct%2F%20%3A%20%2F%5B%2C%5D(%3F%3D(%3F%3A%5B%5E%5C%22%5D%7C%5C%22%5B%5E%5C%22%5D*%5C%22)*%24)%2F%3Blet%20raw_text%20%3D%20await%20getTextFromFile(f)%3Breturn%20%7Btype%3A%20%2F%5C.tsv%2Fi.test(f.name)%20%3F%20'tsv'%20%3A%20'csv'%2C%20delim%3A%20%2F%5C.tsv%2Fi.test(f.name)%20%3F%20'%5Ct'%20%3A%20'%2C'%2C%20table%3Araw_text.split(%2F%5B%5Cn%5Cr%5D%2B%2F).map(rows%3D%3E%20rows.split(x))%7D%3B%7D%20else%20false%3B%7Dasync%20function%20getTextFromFile(d)%7Bvar%20reader%20%3D%20new%20FileReader()%3Breader.readAsText(d)%3Breturn%20new%20Promise(res%3D%3E%20reader.onload%20%3D%20(e)%20%3D%3E%20res(e.target.result))%7D%7D%20initMain()%7D)()
